<!DOCTYPE html>
<html>
<head>
    <title>Dobre praktyki tworzenia oprogramowania</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Arial);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);
      body { font-family: 'Arial'; }
      h1, h2, h3 {
        font-family: 'Arial';
        font-weight: normal;
      }
      .inverse {
        color: white;
        text-shadow: 0 0 20px #333;
      }
      .inverse h1, .inverse h2 {
        color: #f3f3f3;
        line-height: 0.8em;
      }
      .footnote {
        position: absolute;
        bottom: 3em;
      }
      /* Two-column layout */
      .left-column {
        width: 45%;
        height: 92%;
        float: left;
        padding-right: 1em;
      }
      .left-column h2:last-of-type, .left-column h3:last-child {
        color: #000;
      }
      .right-column {
        width: 45%;
        float: right;
        padding-left: 1em;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
</head>
<body>
<textarea id="source">

name: inverse
layout: true
class: inverse

---
layout: false
class: center middle

# Dobre praktyki tworzenia oprogramowania

---
layout: false

## Kim jestem
---

## Kontrakt


---
## Gdzie jesteśmy

Były podstawy na preworku

Znamy składnie dwóch języków (znamy?)

Czy to wystarczy?

---

## Program

Jakość

Czysty kod

Zespołowość

TDD

Object callisthenics

---

layout: false
class: center middle

## Jakość

---

## Jakość

Co to dla Was jest?

Skąd wiecie że Wasza obecna praca ma właściwą jakość?

---

## Jakość w programowaniu

Po czym poznajecie, że Wasz program jest dobrej jakości?

---

layout: false
class: center middle

## Jakość - wymiar zewnętrzny

---

## Aspekty

Dostępność

Funkcje

Poprawność działania

---

layout: false
class: center middle

## Jakość "zewnętrzna" - czyli co?

---

layout: false
class: center middle

## Jakość "zewnętrzna" - czyli co?
### Spełnione oczekiwania klientów

---

## Sposoby zapewnienia

Testy automatyczne

Testy ręczne

Testy wydajnościowe

Monitoring działającego systemu

---
layout: false
class: center middle

## Jakość - wymiar wewnętrzny

---
## Jakość - wymiar wewnętrzny

Czy mieliście wrażenie, że kod Waszego programu przeszkadza Wam w programowaniu

---

## Aspekty

Łatwe wprowadzanie nowych funkcji

Łatwe poprawianie błędów

Łatwość dostarczania ww. zmian klientowi

Łatwość wdrożenia nowych programistów

---
layout: false
class: center middle

## Jakość "wewnętrzna" - czyli co?

---

layout: false
class: center middle

## Był sobie projekt...


---

layout: false
class: center middle

## Jakość "wewnętrzna" - czyli co?
### System tani w utrzymaniu!

---

## Sposoby zapewnienia (niektóre)

Testy automatyczne

Czytelny i zrozumiały kod źródłowy

Programowanie w parach (pair programming)

Przegląd kodu (code review)

---

layout: false
class: center middle

## Czysty kod (clean code)

Kod łatwy do zrozumienia i do zmiany

(czyli właściwie co?)

---

layout: false
class: center middle

## Zobaczmy to na przykładzie

---
## Ćwiczenie - czytelność kodu

Otwórz klasę `com.inqoo.quality.clean.example.bad.Calc`

Uważnie przeczytaj kod metody `calculate`

Co robi ta klasa? Jaka jest jej odpowiedzialność?

Zastanów się na ile łatwa do zrozumienia jest ta klasa

Wskaż co ułatwia Ci zrozumienie tego kodu, a co utrudnia

Co by pomogło Ci zrozumieć ten kod

Spróbuj

10 minut

---

## Ćwiczenie - czytelność kodu

Jak można ten kod poprawić?

Spróbujecie?

---
## Ćwiczenie - czytelność kodu

Otwórz klasę `com.inqoo.quality.clean.example.good.PITCalculator`

Uważnie przeczytaj kod metody `calculate`

Co robi ta klasa? Jaka jest jej odpowiedzialność?

Zastanów się na ile łatwa do zrozumienia jest ta klasa

Wskaż co ułatwia Ci zrozumienie tego kodu, a co utrudnia

Co by pomogło Ci zrozumieć ten kod

10 minut

---

## Ćwiczenie - wnioski

Który kod był bardziej czytelny?

Dlaczego?

Czy o którymś z nich można powiedzieć "idealny"?

---

## Czysty kod

Łatwy do zrozumienia

Samodokumentujący

"Czyta się jak książkę" - test Ivony

---

## Czysty kod

Zrozumiałe nazwy klas, metod i zmiennych

Budowa funkcji (metod)

Klasy

Komentarze

Formatowanie

Obsługa błędów

---

## Dobre nazwy

Zrozumiałe

Możliwie szczegółowe

Nadające sens

Mające znaczenie

Zmniejszają do minimum liczbę potrzebnych komentarzy

---

## Dobre nazwy

Klasy - rzeczowniki
> np. Employee, Reader, Student, Doctor

Metody - czasowniki

> np. save, send, calculate

Zmienne - rzeczowniki

> Litera jako nazwa tylko jako licznik pętli

---
layout: false
class: center middle

## Dobre i złe nazwy - przykłady

---

## Wyrażanie intencji

### Źle

```
int d;
// elapsed time in days
int ds;
int dsm;
int faid;
```

---
## Wyrażanie intencji

### Źle

```
int d;
// elapsed time in days
int ds;
int dsm;
int faid;
```

### Dobrze

```
int elapsedTimeInDays;
int daysSinceCreation;
int daysSinceModification;
int fileAgeInDays;
```
---
## Dezinformacja

### Źle

```
Customer[] customerList;
Table theTable;
```
---
## Dezinformacja

### Źle

```
Customer[] customerList;
Table theTable;
```

### Dobrze

```
Customer[] customers;
Table customers;
```
---

## Długość nazw

### Źle

```
List<Customer> theCustomersListWithAllCustomersIncludedWithoutFilter;
```
---

## Długość nazw

### Źle

```
List<Customer> theCustomersListWithAllCustomersIncludedWithoutFilter;
```

### Dobrze

```
List<Customer> allCustomers

```
---

## Spójność nazw

### Źle

```

void LoadSingleData()
void FetchDataFiltered()
void GetAllData()

```
---

## Spójność nazw

### Źle

```

void LoadSingleData()
void FetchDataFiltered()
void GetAllData()

```

### Dobrze

```

void GetSingleData()
void GetDataFiltered()
void GetAllData()

```

---
## Nazwy dziedzinowe

### Źle
```
public class EntitiesRelation {
    Entity o1;
    Entity o2;
}
```
---
## Nazwy dziedzinowe

### Źle
```
public class EntitiesRelation {
    Entity o1;
    Entity o2;
}
```
### Dobrze
```
public class ProductWithCategory
{
    Product product;
    Category category;
}
```

---
## Nazwy kontekstowe

### Źle
```
class Address{
    String addressCity;
    String addressHomeNumber;
    String addressPostalCode;
}
```

---
## Nazwy kontekstowe

### Źle
```
class Address{
    String addressCity;
    String addressHomeNumber;
    String addressPostalCode;
}
```
### Dobrze
```
class Address{
    String city;
    String homeNumber;
    String postalCode;
}
```


---
layout: false
class: center middle

## Ćwiczenia - wprowadzenie

---
## Ćwiczenia - wprowadzenie

W pakiecie `com.inqoo.quality.clean.library.exercises` znajdziecie prosty program zarządzające biblioteką.

Pracowała nad nim wynajęta firma outsourcingowa, która wbrew umowia dostarczyła <s>zasoby</s> ludzi z niżyszmi niż ustalone kompetencjami.
Zamiast seniora i mida, było 1/8 seniora oraz 1 i 7/8 juniora po stawce _blended_ .

Ze względu na RODO nie wiemy nawet w jakim kraju to powstawało i chyba wolimy nie wiedzieć.

W ocenie wynajętej firmy konsultingowej z Lublina kod jest bardzo słabej jakości i klient może zakwestionować te prace.
Konsultantom udało się napisać testy, potem skończył się budżet na ich usługi.

Prawnicy pracują nad pozwem, ale proces nie ruszy przed deadlinem.

No - musicie to wyprostować.

---
layout: false
class: center middle

## Nazwy - ćwiczenia

---
## Ćwiczenie

Zacznijmy od klasy `Library`.

Jest to punkt wejścia do całego modułu - czyli jedyna klasa publiczna w tym pakiecie. To jej metody będą wywoływać aplikacje
mobilne czytelniczek oraz czytelników i _backoffice_ bibliotekarek oraz bibliotekarzy .

Z raportu konsultantów wynika, że w tej klasie bezwzględnie trzeba poprawić nazwy:
- pól tej klasy
- metod klasy `Library`
- klas do których `Library` się odnosi
- metod klas do których `Library` się odnosi

Wskazówki

- W IntelliJ IDEA nazwy można zmienić skrótem Shift+F6
- Pamiętajcie o wykonaniu testów po każdej zmianie

---
layout: false
class: center middle

## Nazwy - podsumowanie
---
layout: false
class: center middle

## Budowa funkcji (metod)
---
## Po czym poznać dobrą metodę?

Krótka

Mało wcięć

Robi jedną rzecz

Mało paramterów

---

## Jak pracować z metodami?

Podział metody na mniejsze

Grupowanie parametrów w klasy

Podejście top-bottom, od najbardziej ogólnych do najbardziej szczegółowych

Opakowywać złożone warunki logiczne w metody prywatne

---
layout: false
class: center middle

## Metody - przykład

---
layout: false
class: center middle

## Metody - ćwiczenie
---
## Metody - ćwiczenie

TODO
TODO
---
layout: false
class: center middle

## Metody - podsumowanie

---
layout: false
class: center middle

## Klasy

---
## Cechy dobrej klasy

Krótka

Spójna

Skupiona na zbliżonych zadaniach

---
## Heurystyki związane z klasami

SOLID

Prawo Demeter

---
## SOLID

SRP - Single Responsibility Principle

OCP - Open-Closed Principle

LSP - Liskov Substitution Principle

ISP - Interface Seperation Principle

DIP - Dependency Inversion Principle

---
## SRP - Single Responsibility Principle

Klasa ma

> - pojedynczą odpowiedzialność

> - jeden powód do zmiany

no, generalnie robi jedną rzecz
---
## SRP - Single Responsibility Principle

"Robi jedną rzecz", czyli np.:

Oblicza podatek

Wypożycza książki

Jest katalogiem klientów

Przeprowadza operacje odczytu/zapisu/modyfikacji na bazie danych

Wywołuje inne metody na innej klasie

---
## SRP - przykład
---
## OCP - Open-Closed Principle

Otwarta na rozszerzenia - zamknięta na modyfikacje

---
## OCP - Open-Closed Principle
---
## LSP - Liskov Substitution Principle

Przy wymianie różnych implementacji interfejsu system zachowuje się tak samo

---
## LSP - przykłady

TODO

---
## ISP - Interface Seperation Principle
---
## ISP - przykłady

TODO

---
## DIP - Dependency Inversion Principle
---
## DIP - przykłady

TODO

---
layout: false
class: center middle

## Prawo Demeter

---

## Prawo Demeter

Nie rozmawiaj z nieznajomymi

---

## Prawo Demeter bardziej formalnie

Metoda danego obiektu może odwoływać się jedynie do metod należących do:

- tego samego obiektu
- dowolnego parametru przekazanego do niej
- dowolnego obiektu przez nią stworzonego
- dowolnego składnika klasy, do której należy dana metoda

---

## Prawo Demeter - przykłady


---
layout: false
class: center middle

## Klasy - ćwiczenie

---

## Klasy - ćwiczenie

---
layout: false
class: center middle

## Klasy - podsumowanie

---
layout: false
class: center middle

## Komentarze

---
## Komentarze

Nie powinny zastępować czytelnych nazw w kodzie

Kod wymagający komentarzy jest jak dowcip wymagający tłumaczenia

Powinny wyjaśniać rozumowanie za "dziwnym" miejscem w kodzie
---
layout: false
class: center middle

## Czysty kod - podsumowanie

---

## Czysty kod - podsumowanie

Odpowiadamy za to wszyscy

Wszyscy musimy żyć ze złym kodem

"Wybita szyba"

"Boy Scout Rule"

Refaktoryzacja

---
layout: false
class: center middle

## Boy Scout Rule

Leave your code better than you found it

---
layout: false
class: center middle

## Boy Scout Rule

Leave your code better than you found it

(but not build national park around it)

---
layout: false
class: center middle

## Refaktoryzacja

ulepszanie struktury istniejącego kodu, bez zmiany jego zachowania

---
## Techniki refaktoryzacji (niektóre :) )

Zmiana nazwy zmiennej

Ekstrakcja metody

Ekstrakcja klasy

---
layout: false
class: center middle

## Zespołowość

---

## Zespołowość

Nie pracujemy w próżni

Odpowiadamy za całość jako zespół!

---

## Programowanie w parach/w tłumie

Cel: natychmiastowa informacja zwrotna o jakości kodu

Jeden robi jak się patrzy, reszta patrzy jak się robi

Częste zmiany ról

---

## Przeglądanie kodu (code review)

Cele:

- informacja zwrotna o jakości kodu

- komunikacja w zespole

---
layout: false
class: center middle

## TDD
---
## TDD

Red - green - refactor

BDD

TODO <obrazek></obrazek>
---
## Budowa testu

Given

> Przygotowanie testu

When

> Wykonanie operacji, której wynik chcemy sprawdzić

Then

> Sprawdzamy wynik tego co testujemy

---

## Test fixtures

Klasy odpowiedzialne za przygotowanie danych testowych

```
class BookFixture {
    Book paleBlueDot() {
        return new Book(ISBN.of("0-679-43841-6"), "Carl Sagan", "Pale Blue Dot");
    }

    Book cleanCode() {
        return new Book(ISBN.of("978-0132350884"), "Robert C. Martin", "Clean Code");
    }
}
```

---
## Assertions


---
layout: false
class: center middle

## TDD - String Calculator

---
## TDD - String Calculator - krok 1

Utwórz klasę StringCalculator z metodą

```
int Add(String numbers)
```
Metoda przyjmuje do dwóch liczb odzdzielonych przecinkami i zwraca ich sumę,
np. "", "1", "1,2"

Pusty napis zwraca 0.

---
## TDD - String Calculator - krok 2

Metoda `add` powinna obsługiwać dowolną liczbę liczb
---
## TDD - String Calculator - krok 3

Metoda `add` powinna przyjmować znak nowej lini zamiast przecinka:

Np. sekwencja "1\n2,3” jest poprawna i zwraca 6.

Celem wyjaśnienia:“1,\n” nie jest poprawna
---
## TDD - String Calculator - krok 4

Wspieraj różne rozgraniczniki.

By zmienić znak rozgraniczający na początku napisu będzie umieszczona linia postaci "//[delimiter]\n[numbers…]", np. "//;\n1;2"
zwróci 3, a znak rozgraniczający to ";"

Pierwsza linia jest opcjonalna. Wszystkie poprzednie scenariusze mają działać.

---
## TDD - String Calculator - krok 5

Wywołanie dodawania z liczbą ujemną powinno wyrzucić wyjątek z wiadomością “negatives not allowed” - i liczbami ujemnymi, które spowodowały błąd.

Jeśli liczb ujemnych jest więcej pokaż jest wszystkie

---
## TDD - String Calculator - krok 6

Liczby większe niż 1000 powinny być ignorowane, czyli:

2 + 1001 = 2

---
## TDD - String Calculator - krok 7

Rozgraniczniki mogą być dowolnej długości: “//[delimiter]\n”, na przykład: “//[***]\n1***2***3” daje w wyniku 6.

---
## TDD - String Calculator - krok 8

Można użyć wielu rozgraniczników: “//[delim1][delim2]\n”, na przykłąd “//[*][%]\n1*2%3” daje w wyniku 6.

---
## TDD - String Calculator - krok 9

Zapewnij że program wspiera wiele wieloznakowych rozgraniczników

---
layout: false
class: center middle

## TDD - podsumowanie

---
layout: false
class: center middle

## Vending machine

---
## Object callisthenics

Only One Level Of Indentation Per Method

Don’t Use The ELSE Keyword

Wrap All Primitives And Strings

First Class Collections

One Dot Per Line

Don’t Abbreviate

Keep All Entities Small

No Classes With More Than Two Instance Variables

No Getters/Setters/Properties

---

## One Level Of Indentation Per Method
```
    public String board() {
        StringBuilder buf = new StringBuilder();
        for (int i = 0; i < 10; i++) {
            for (int j = 0; j < 10; j++) {
                buf.append(data[i][j]);
            }
            buf.append("\n");
        }
        return buf.toString();
    }
```
---

## One Level Of Indentation Per Method

```
    public String board() {
        StringBuilder buf = new StringBuilder();
        collectRows(buf);
        return buf.toString();
    }

    private void collectRows(StringBuilder buf) {
        for (int i = 0; i < 10; i++) {
            collectRow(buf, i);
        }
    }

    private void collectRow(StringBuilder buf, int row) {
        for (int i = 0; i < 10; i++) {
            buf.append(data[row][i]);
        }
        buf.append("\n");
    }
```
---
## Don’t Use The ELSE Keyword
```
public AuthResult login(String username, String password) {
    if (userRepository.isValid(username, password)) {
        return AuthResult.SUCCESS;
    } else {
        return AuthRestult.FAILURE;
    }
}
```
---
## Don’t Use The ELSE Keyword
```
public AuthResult login(String username, String password) {
    if (userRepository.isValid(username, password)) {
        return AuthResult.SUCCESS;
    }
    return AuthRestult.FAILURE;
}
```
lub
```
public AuthResult login(String username, String password) {
    return userRepository.isValid(username, password)
        ? AuthResult.SUCCESS;
        : AuthRestult.FAILURE;
}
```


---
## Wrap All Primitives And Strings
```
class ISBN {
    static ISBN of(String rawIsbn) {
        return new ISBN(rawIsbn);
    }

    private final String raw;

    private ISBN(String raw) {
        this.raw = raw;
    }
}
```
---
## First Class Collections
```
class MyClass {
    List<Book> books = new ArrayList<>();
}
```
---
## First Class Collections
```
class Books {
    List<Book> books = new ArrayList<>();

    void Add() {
        books.add(book);
    }
}
```
---
## One Dot Per Line

prawo Demeter
```
    crocodile.getStomach().put(sausage);

```

---
## One Dot Per Line

```
    crocodile.feed(sausage);

    class Crocodile() {
        Stomach stomach;
        feed(Food food) {
            stomach.put(food);
        }
    }

```

---
## Don’t Abbreviate

Just no

---
## Keep All Entities Small

No class over 50 lines
---
## Max Two Fields Per Class

That's quite obvious
---
## No Getters/Setters/Properties

That's quite obvious

---
## Vending machine - feature 1

The vending machine will accept valid coins (nickels, dimes, and quarters) and reject invalid ones (pennies).

When a valid coin is inserted the amount of the coin will be added to the current amount and the display will be updated.

When there are no coins inserted, the machine displays INSERT COIN. Rejected coins are placed in the coin return.

---
## Vending machine - feature 2


There are three products: cola for $1.00, chips for $0.50, and candy for $0.65.

When the respective button is pressed and enough money has been inserted, the product is dispensed and the machine displays THANK YOU.

If the display is checked again, it will display INSERT COIN and the current amount will be set to $0.00.

If there is not enough money inserted then the machine displays PRICE and the price of the item and subsequent checks of the display

will display either INSERT COIN or the current amount as appropriate.

---
## Vending machine - feature 3

When a product is selected that costs less than the amount of money in the machine, then the remaining amount is placed in the coin return.

---
## Vending machine - feature 4

When the return coins button is pressed, the money the customer has placed in the machine is returned and the display shows INSERT COIN.

---
## Vending machine - feature 5

When the item selected by the customer is out of stock, the machine displays SOLD OUT.

If the display is checked again, it will display the amount of money remaining in the machine or INSERT COIN if there is no money in the machine.


---
## Vending machine - feature 6

When the machine is not able to make change with the money in the machine for any of the items that it sells, it will display EXACT CHANGE ONLY instead of INSERT COIN.



---
layout: false
class: center middle

## Warsztat - podsumowanie
---
layout: false
class: center middle

## Rozwój własny


---
## Jak się tego uczyć?

Programować, programować, programować

Czytać, czytać, słuchać, oglądać

---
layout: false
class: center middle

## Projekt do domu

---
## Sudoku

Gra polega na wypełnieniu planszy cyframi od 1 do 9 w ten sposób, aby
- w tym samym wierszu,
- w tej samej kolumnie,
- oraz w każdym sektorze 3×3 oznaczonym pogrubiona linią,
znajdowała się tylko jedna taka sama cyfra.

Innymi słowy w żadnej kolumnie, wierszu, lub oznaczonym sektorze nie może powtórzyć się dwa razy ta sama cyfra.

---
layout: false
background-image: url(sudoku.gif)
background-size: contain
background-repeat: no-repeat
background-position: bottom
class: center top
---
## Sudoku

Trzymamy się:

TDD

Object Callisthenics

---
## Materiały dodatkowe

TDD by Example

Kata Oli Kunysz

Kata Sandro Mancuso

Pair programming pragmatycznie - Szabel

Code review pragmatycznie - Sebastian Malaca

---

class: center middle

# Thank you!

</textarea>
<script src="https://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript"></script>
<script type="text/javascript">
      var slideshow = remark.create({
        countIncrementalSlides: false
      });
    </script>
</body>
</html>